<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:a="http://schemas.actiprosoftware.com/avaloniaui"
             xmlns:pages="clr-namespace:AutoSpex.Client.Pages"
             xmlns:components="clr-namespace:AutoSpex.Client.Components"
             xmlns:observers="clr-namespace:AutoSpex.Client.Observers"
             xmlns:properties="clr-namespace:AutoSpex.Client.Resources.Properties"
             x:Class="AutoSpex.Client.Pages.SourcesPage"
             x:DataType="pages:SourcesPageModel">

    <Design.Height>800</Design.Height>
    <Design.Width>400</Design.Width>

    <components:NavigationTree ItemsSource="{Binding Sources}"
                               AddCommand="{Binding AddSourceCommand}">
        <components:NavigationTree.ItemContainerTheme>
            <ControlTheme TargetType="components:NavigationTreeItem" BasedOn="{StaticResource NavigationTreeItem}"
                          x:DataType="observers:SourceObserver">
                <Setter Property="ItemName" Value="{Binding Name}" />
                <Setter Property="IconTheme" Value="{StaticResource IconSourceThemed}" />
                <Setter Property="NavigateCommand" Value="{Binding NavigateCommand}" />
                <Setter Property="RenameCommand" Value="{Binding RenameCommand}" />
                <Setter Property="ItemIndent" Value="0" />
            </ControlTheme>
        </components:NavigationTree.ItemContainerTheme>
        <components:NavigationTree.ItemTemplate>
            <TreeDataTemplate x:DataType="observers:SourceObserver">
                <Grid ColumnDefinitions="*,Auto">
                    <StackPanel Grid.Column="0" Orientation="Horizontal" Spacing="5">
                        <TextBlock Text="{Binding Name}" />
                        <TextBlock Text="{Binding TargetTypeFormatted}"
                                   Foreground="{a:ThemeResource DefaultForegroundBrushTertiary}"/>
                    </StackPanel>
                    <Button Grid.Column="1" Command="{Binding SelectCommand}"
                            Theme="{StaticResource IconButton}"
                            properties:ButtonIcon.Theme="{StaticResource IconCheckCircleFilled}"
                            Foreground="{a:ThemeResource DefaultForegroundBrushDisabled}"
                            Classes.active="{Binding IsSelected}"
                            ToolTip.Tip="Select source">
                        <Button.Styles>
                            <Style Selector=".active /template/ PathIcon">
                                <Setter Property="Foreground"
                                        Value="{a:ThemeResource ControlForegroundBrushOutlineAccent}" />
                            </Style>
                        </Button.Styles>
                        <Button.IsVisible>
                            <MultiBinding Converter="{x:Static BoolConverters.Or}">
                                <Binding Path="IsSelected" />
                                <Binding Path="$parent[components:NavigationItem].IsPointerOver" />
                            </MultiBinding>
                        </Button.IsVisible>
                    </Button>
                </Grid>
            </TreeDataTemplate>
        </components:NavigationTree.ItemTemplate>
    </components:NavigationTree>
</UserControl>