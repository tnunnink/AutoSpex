<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:a="http://schemas.actiprosoftware.com/avaloniaui"
             xmlns:controls="clr-namespace:AutoSpex.Client.Resources.Controls"
             xmlns:pages="clr-namespace:AutoSpex.Client.Pages"
             xmlns:components="clr-namespace:AutoSpex.Client.Components"
             xmlns:observers="clr-namespace:AutoSpex.Client.Observers"
             xmlns:properties="clr-namespace:AutoSpex.Client.Resources.Properties"
             x:Class="AutoSpex.Client.Pages.FilterEntryPage"
             x:DataType="pages:FilterEntryPageModel"
             Height="300" Width="400">

    <controls:Prompt Header="Add filter"
                     Padding="20"
                     HeaderIcon="{StaticResource IconFilter}"
                     CancelButtonTheme="{a:ControlTheme ButtonSoft}"
                     CancelCommandParameter="{x:Null}"
                     ActionButtonText="Add"
                     ActionButtonTheme="{a:ControlTheme ButtonSolid}"
                     ActionCommand="{Binding AddFilterCommand}"
                     ActionCommandParameter="{Binding $parent[Window]}"
                     Classes="accent">
        <ScrollViewer>
            <StackPanel Spacing="10">
                <StackPanel.Styles>
                    <Style Selector="Border.separator">
                        <Setter Property="BorderThickness" Value="1 0 0 0" />
                        <Setter Property="BorderBrush" Value="{a:ThemeResource Container1BorderBrush}" />
                        <Setter Property="Margin" Value="5" />
                    </Style>
                </StackPanel.Styles>
                
                <TextBlock Text="{Binding Element.Name}" />

                <components:PropertyEntry
                    OriginType="{Binding Element.Type}"
                    Property="{Binding Property}"
                    PropertyName="{Binding PropertyName}" />

                <components:OperationEntry
                    IsVisible="{Binding Property, Converter={x:Static ObjectConverters.IsNotNull}}"
                    Operation="{Binding Operation}"
                    Property="{Binding Property}" />

                <ItemsControl
                    ItemsSource="{Binding Arguments}">
                    <ItemsControl.ItemsPanel>
                        <ItemsPanelTemplate>
                            <StackPanel Orientation="Horizontal" />
                        </ItemsPanelTemplate>
                    </ItemsControl.ItemsPanel>
                    <ItemsControl.DataTemplates>
                        <components:ArgumentEntryTemplates>
                            <DataTemplate x:Key="Default"
                                          x:DataType="observers:ArgumentObserver">
                                <StackPanel Orientation="Horizontal">
                                    <components:ArgumentEntry Argument="{Binding }" />
                                    <Border BorderThickness="1 0 0 0"
                                            BorderBrush="{a:ThemeResource Container1BorderBrush}"
                                            Margin="5" />
                                </StackPanel>
                            </DataTemplate>
                            <DataTemplate x:Key="Criterion"
                                          x:DataType="observers:ArgumentObserver">
                                <components:CriterionEntry Criterion="{Binding Value}" />
                            </DataTemplate>
                            <DataTemplate x:Key="In"
                                          x:DataType="observers:ArgumentObserver">
                                <StackPanel Orientation="Horizontal">
                                    <components:ArgumentEntry Argument="{Binding }" />
                                    <Button Theme="{StaticResource IconButton}"
                                            properties:ButtonIcon.Theme="{StaticResource IconAdd}" />
                                </StackPanel>
                            </DataTemplate>
                        </components:ArgumentEntryTemplates>
                    </ItemsControl.DataTemplates>
                </ItemsControl>
            </StackPanel>
        </ScrollViewer>
    </controls:Prompt>
</UserControl>