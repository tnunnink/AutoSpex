<ResourceDictionary xmlns="https://github.com/avaloniaui"
                    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
                    xmlns:observers="clr-namespace:AutoSpex.Client.Observers"
                    xmlns:controls="clr-namespace:AutoSpex.Client.Resources.Controls"
                    xmlns:components="clr-namespace:AutoSpex.Client.Components">

    <Design.PreviewWith>
        <Border Width="300" Height="200">
            <TreeView ItemsSource="{x:Static components:TestData.Results}"
                      ItemTemplate="{DynamicResource ResultTreeItem}"
                      ItemContainerTheme="{DynamicResource ResultTreeItemTheme}"
                      Padding="10" />
        </Border>
    </Design.PreviewWith>


    <TreeDataTemplate x:Key="ResultTreeItem" x:DataType="observers:ResultObserver" ItemsSource="{Binding Nodes}">

        <Border Background="Transparent" Focusable="True" IsTabStop="False">

            <Border.Styles>
                <Style Selector="controls|HighlightableTextBlock">
                    <Setter Property="HighlightedText" Value="{Binding FilterText}" />
                </Style>
            </Border.Styles>

            <StackPanel Orientation="Horizontal" Spacing="5" ClipToBounds="True">

                <PathIcon
                    Theme="{Binding Result, Converter={StaticResource ResultStateIconConverter}}"
                    Classes.spinning="{Binding Result.IsProcessing}"
                    FontSize="14">

                    <PathIcon.Styles>
                        <Style Selector="PathIcon.spinning">
                            <Style.Animations>
                                <Animation Duration="0:0:1" IterationCount="INFINITE">
                                    <KeyFrame Cue="0%">
                                        <Setter Property="RotateTransform.Angle" Value="0" />
                                    </KeyFrame>
                                    <KeyFrame Cue="100%">
                                        <Setter Property="RotateTransform.Angle" Value="360" />
                                    </KeyFrame>
                                </Animation>
                            </Style.Animations>
                        </Style>
                    </PathIcon.Styles>

                </PathIcon>

                <controls:HighlightableTextBlock
                    Text="{Binding Name}" />

            </StackPanel>

        </Border>
    </TreeDataTemplate>

    <ControlTheme x:Key="ResultTreeItemTheme" TargetType="TreeViewItem" BasedOn="{StaticResource TreeViewItemSimple}"
                  x:DataType="observers:NodeObserver">
        <Setter Property="IsVisible" Value="{Binding IsVisible}" />
        <Setter Property="IsSelected" Value="{Binding IsSelected}" />
        <Setter Property="IsExpanded" Value="{Binding IsExpanded}" />
    </ControlTheme>
</ResourceDictionary>